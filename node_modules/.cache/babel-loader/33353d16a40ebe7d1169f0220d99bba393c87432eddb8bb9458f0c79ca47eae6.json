{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useState, useEffect } from 'react';\nimport { useApi } from './useApi';\nimport { useSocket } from './useSocket';\nexport const useSchools = () => {\n  _s();\n  const {\n    loading,\n    error,\n    getActiveSchools,\n    clearError\n  } = useApi();\n  const {\n    socketService,\n    isConnected\n  } = useSocket();\n  const [schools, setSchools] = useState([]);\n\n  // Load schools\n  const loadSchools = async () => {\n    try {\n      const response = await getActiveSchools();\n      if (response.success) {\n        setSchools(response.data);\n      }\n    } catch (err) {\n      console.error('Failed to load schools:', err);\n    }\n  };\n\n  // Set data when component mounts\n  useEffect(() => {\n    loadSchools();\n  }, []);\n\n  // Real-time event listeners\n  useEffect(() => {\n    if (!socketService || !isConnected) return;\n    console.log('ðŸ”Œ Setting up school listeners...');\n    const handleNew = newSchool => {\n      console.log('ðŸ« New school:', newSchool);\n      setSchools(prev => [newSchool, ...prev]);\n    };\n    const handleUpdate = updatedSchool => {\n      console.log('ðŸ« Updated school:', updatedSchool);\n      setSchools(prev => prev.map(item => item._id === updatedSchool._id ? updatedSchool : item));\n    };\n    const handleDelete = deletedData => {\n      console.log('ðŸ« Deleted school:', deletedData.id);\n      setSchools(prev => prev.filter(item => item._id !== deletedData.id));\n    };\n\n    // Register listeners using socketService\n    socketService.on('school_created', handleNew);\n    socketService.on('school_updated', handleUpdate);\n    socketService.on('school_deleted', handleDelete);\n\n    // Cleanup\n    return () => {\n      socketService.off('school_created', handleNew);\n      socketService.off('school_updated', handleUpdate);\n      socketService.off('school_deleted', handleDelete);\n    };\n  }, [socketService, isConnected]);\n  const refetch = () => {\n    loadSchools();\n  };\n  return {\n    schools,\n    loading,\n    error,\n    refetch,\n    isConnected\n  };\n};\n_s(useSchools, \"ukbOvo5WXFM7eZ1VTnAFMeXhMNA=\", false, function () {\n  return [useApi, useSocket];\n});","map":{"version":3,"names":["useState","useEffect","useApi","useSocket","useSchools","_s","loading","error","getActiveSchools","clearError","socketService","isConnected","schools","setSchools","loadSchools","response","success","data","err","console","log","handleNew","newSchool","prev","handleUpdate","updatedSchool","map","item","_id","handleDelete","deletedData","id","filter","on","off","refetch"],"sources":["C:/jbmmsi/client/src/hooks/useSchools.js"],"sourcesContent":["import { useState, useEffect } from 'react';\r\nimport { useApi } from './useApi';\r\nimport { useSocket } from './useSocket';\r\n\r\nexport const useSchools = () => {\r\n  const { loading, error, getActiveSchools, clearError } = useApi();\r\n  const { socketService, isConnected } = useSocket();\r\n  const [schools, setSchools] = useState([]);\r\n\r\n  // Load schools\r\n  const loadSchools = async () => {\r\n    try {\r\n      const response = await getActiveSchools();\r\n      if (response.success) {\r\n        setSchools(response.data);\r\n      }\r\n    } catch (err) {\r\n      console.error('Failed to load schools:', err);\r\n    }\r\n  };\r\n\r\n  // Set data when component mounts\r\n  useEffect(() => {\r\n    loadSchools();\r\n  }, []);\r\n\r\n  // Real-time event listeners\r\n  useEffect(() => {\r\n    if (!socketService || !isConnected) return;\r\n\r\n    console.log('ðŸ”Œ Setting up school listeners...');\r\n\r\n    const handleNew = (newSchool) => {\r\n      console.log('ðŸ« New school:', newSchool);\r\n      setSchools(prev => [newSchool, ...prev]);\r\n    };\r\n\r\n    const handleUpdate = (updatedSchool) => {\r\n      console.log('ðŸ« Updated school:', updatedSchool);\r\n      setSchools(prev => \r\n        prev.map(item => \r\n          item._id === updatedSchool._id ? updatedSchool : item\r\n        )\r\n      );\r\n    };\r\n\r\n    const handleDelete = (deletedData) => {\r\n      console.log('ðŸ« Deleted school:', deletedData.id);\r\n      setSchools(prev => \r\n        prev.filter(item => item._id !== deletedData.id)\r\n      );\r\n    };\r\n\r\n    // Register listeners using socketService\r\n    socketService.on('school_created', handleNew);\r\n    socketService.on('school_updated', handleUpdate);\r\n    socketService.on('school_deleted', handleDelete);\r\n\r\n    // Cleanup\r\n    return () => {\r\n      socketService.off('school_created', handleNew);\r\n      socketService.off('school_updated', handleUpdate);\r\n      socketService.off('school_deleted', handleDelete);\r\n    };\r\n  }, [socketService, isConnected]);\r\n\r\n  const refetch = () => {\r\n    loadSchools();\r\n  };\r\n\r\n  return {\r\n    schools,\r\n    loading,\r\n    error,\r\n    refetch,\r\n    isConnected\r\n  };\r\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}