{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useState, useEffect } from 'react';\nimport { useApi } from './useApi.js';\nimport { useSocket } from '../context/SocketContext.js';\nexport const useSchools = () => {\n  _s();\n  const API_BASE_URL = process.env.REACT_APP_API_BASE_URL;\n  const {\n    data,\n    loading,\n    error,\n    refetch\n  } = useApi(`${API_BASE_URL}/api/schools`);\n  const {\n    on,\n    off,\n    isConnected\n  } = useSocket();\n  const [schools, setSchools] = useState([]);\n  useEffect(() => {\n    if (data) {\n      setSchools(data);\n    }\n  }, [data]);\n  useEffect(() => {\n    if (!isConnected) return;\n    console.log('ðŸ”Œ Setting up school listeners...');\n    const handleNew = newSchool => {\n      console.log('ðŸ« New school:', newSchool);\n      setSchools(prev => [...prev, newSchool]);\n    };\n    const handleUpdate = updatedSchool => {\n      console.log('ðŸ« Updated school:', updatedSchool);\n      setSchools(prev => prev.map(item => item._id === updatedSchool._id ? updatedSchool : item));\n    };\n    const handleDelete = deletedData => {\n      console.log('ðŸ« Deleted school:', deletedData.id);\n      setSchools(prev => prev.filter(item => item._id !== deletedData.id));\n    };\n    on('school_created', handleNew);\n    on('school_updated', handleUpdate);\n    on('school_deleted', handleDelete);\n    return () => {\n      off('school_created', handleNew);\n      off('school_updated', handleUpdate);\n      off('school_deleted', handleDelete);\n    };\n  }, [on, off, isConnected]);\n  return {\n    schools,\n    loading,\n    error,\n    refetch,\n    isConnected\n  };\n};\n_s(useSchools, \"lx9OKN3yyWJ/VPPOnM/5sUHAPV0=\", false, function () {\n  return [useApi, useSocket];\n});","map":{"version":3,"names":["useState","useEffect","useApi","useSocket","useSchools","_s","API_BASE_URL","process","env","REACT_APP_API_BASE_URL","data","loading","error","refetch","on","off","isConnected","schools","setSchools","console","log","handleNew","newSchool","prev","handleUpdate","updatedSchool","map","item","_id","handleDelete","deletedData","id","filter"],"sources":["C:/jbmmsi/client/src/hooks/useSchools.js"],"sourcesContent":["import { useState, useEffect } from 'react';\r\nimport { useApi } from './useApi.js';\r\nimport { useSocket } from '../context/SocketContext.js';\r\n\r\nexport const useSchools = () => {\r\n  const API_BASE_URL = process.env.REACT_APP_API_BASE_URL;\r\n  const { data, loading, error, refetch } = useApi(`${API_BASE_URL}/api/schools`);\r\n  const { on, off, isConnected } = useSocket();\r\n  const [schools, setSchools] = useState([]);\r\n\r\n  useEffect(() => {\r\n    if (data) {\r\n      setSchools(data);\r\n    }\r\n  }, [data]);\r\n\r\n  useEffect(() => {\r\n    if (!isConnected) return;\r\n\r\n    console.log('ðŸ”Œ Setting up school listeners...');\r\n\r\n    const handleNew = (newSchool) => {\r\n      console.log('ðŸ« New school:', newSchool);\r\n      setSchools(prev => [...prev, newSchool]);\r\n    };\r\n\r\n    const handleUpdate = (updatedSchool) => {\r\n      console.log('ðŸ« Updated school:', updatedSchool);\r\n      setSchools(prev => \r\n        prev.map(item => \r\n          item._id === updatedSchool._id ? updatedSchool : item\r\n        )\r\n      );\r\n    };\r\n\r\n    const handleDelete = (deletedData) => {\r\n      console.log('ðŸ« Deleted school:', deletedData.id);\r\n      setSchools(prev => \r\n        prev.filter(item => item._id !== deletedData.id)\r\n      );\r\n    };\r\n\r\n    on('school_created', handleNew);\r\n    on('school_updated', handleUpdate);\r\n    on('school_deleted', handleDelete);\r\n\r\n    return () => {\r\n      off('school_created', handleNew);\r\n      off('school_updated', handleUpdate);\r\n      off('school_deleted', handleDelete);\r\n    };\r\n  }, [on, off, isConnected]);\r\n\r\n  return {\r\n    schools,\r\n    loading,\r\n    error,\r\n    refetch,\r\n    isConnected\r\n  };\r\n};"],"mappings":";AAAA,SAASA,QAAQ,EAAEC,SAAS,QAAQ,OAAO;AAC3C,SAASC,MAAM,QAAQ,aAAa;AACpC,SAASC,SAAS,QAAQ,6BAA6B;AAEvD,OAAO,MAAMC,UAAU,GAAGA,CAAA,KAAM;EAAAC,EAAA;EAC9B,MAAMC,YAAY,GAAGC,OAAO,CAACC,GAAG,CAACC,sBAAsB;EACvD,MAAM;IAAEC,IAAI;IAAEC,OAAO;IAAEC,KAAK;IAAEC;EAAQ,CAAC,GAAGX,MAAM,CAAC,GAAGI,YAAY,cAAc,CAAC;EAC/E,MAAM;IAAEQ,EAAE;IAAEC,GAAG;IAAEC;EAAY,CAAC,GAAGb,SAAS,CAAC,CAAC;EAC5C,MAAM,CAACc,OAAO,EAAEC,UAAU,CAAC,GAAGlB,QAAQ,CAAC,EAAE,CAAC;EAE1CC,SAAS,CAAC,MAAM;IACd,IAAIS,IAAI,EAAE;MACRQ,UAAU,CAACR,IAAI,CAAC;IAClB;EACF,CAAC,EAAE,CAACA,IAAI,CAAC,CAAC;EAEVT,SAAS,CAAC,MAAM;IACd,IAAI,CAACe,WAAW,EAAE;IAElBG,OAAO,CAACC,GAAG,CAAC,mCAAmC,CAAC;IAEhD,MAAMC,SAAS,GAAIC,SAAS,IAAK;MAC/BH,OAAO,CAACC,GAAG,CAAC,gBAAgB,EAAEE,SAAS,CAAC;MACxCJ,UAAU,CAACK,IAAI,IAAI,CAAC,GAAGA,IAAI,EAAED,SAAS,CAAC,CAAC;IAC1C,CAAC;IAED,MAAME,YAAY,GAAIC,aAAa,IAAK;MACtCN,OAAO,CAACC,GAAG,CAAC,oBAAoB,EAAEK,aAAa,CAAC;MAChDP,UAAU,CAACK,IAAI,IACbA,IAAI,CAACG,GAAG,CAACC,IAAI,IACXA,IAAI,CAACC,GAAG,KAAKH,aAAa,CAACG,GAAG,GAAGH,aAAa,GAAGE,IACnD,CACF,CAAC;IACH,CAAC;IAED,MAAME,YAAY,GAAIC,WAAW,IAAK;MACpCX,OAAO,CAACC,GAAG,CAAC,oBAAoB,EAAEU,WAAW,CAACC,EAAE,CAAC;MACjDb,UAAU,CAACK,IAAI,IACbA,IAAI,CAACS,MAAM,CAACL,IAAI,IAAIA,IAAI,CAACC,GAAG,KAAKE,WAAW,CAACC,EAAE,CACjD,CAAC;IACH,CAAC;IAEDjB,EAAE,CAAC,gBAAgB,EAAEO,SAAS,CAAC;IAC/BP,EAAE,CAAC,gBAAgB,EAAEU,YAAY,CAAC;IAClCV,EAAE,CAAC,gBAAgB,EAAEe,YAAY,CAAC;IAElC,OAAO,MAAM;MACXd,GAAG,CAAC,gBAAgB,EAAEM,SAAS,CAAC;MAChCN,GAAG,CAAC,gBAAgB,EAAES,YAAY,CAAC;MACnCT,GAAG,CAAC,gBAAgB,EAAEc,YAAY,CAAC;IACrC,CAAC;EACH,CAAC,EAAE,CAACf,EAAE,EAAEC,GAAG,EAAEC,WAAW,CAAC,CAAC;EAE1B,OAAO;IACLC,OAAO;IACPN,OAAO;IACPC,KAAK;IACLC,OAAO;IACPG;EACF,CAAC;AACH,CAAC;AAACX,EAAA,CAxDWD,UAAU;EAAA,QAEqBF,MAAM,EACfC,SAAS;AAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}