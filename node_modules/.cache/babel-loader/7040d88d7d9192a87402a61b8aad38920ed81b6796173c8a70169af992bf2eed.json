{"ast":null,"code":"import{io}from'socket.io-client';import{SOCKET_CONFIG}from'../config';class SocketService{constructor(){this.socket=null;this.isConnected=false;this.listeners=new Map();}connect(){if(this.socket&&this.isConnected){return this.socket;}console.log('ðŸ”Œ Connecting to WebSocket...');this.socket=io(SOCKET_CONFIG.URL,{transports:['websocket','polling'],timeout:10000});this.socket.on('connect',()=>{console.log('âœ… Connected to server via WebSocket');this.isConnected=true;});this.socket.on('disconnect',reason=>{console.log('âŒ Disconnected from server:',reason);this.isConnected=false;});this.socket.on('connect_error',error=>{console.error('âŒ WebSocket connection error:',error);this.isConnected=false;});this.socket.on('connected',data=>{console.log('Server connection confirmed:',data.message);});return this.socket;}// Join specific rooms\njoinAnnouncements(){if(this.socket){this.socket.emit('join_announcements');}}joinSchools(){if(this.socket){this.socket.emit('join_schools');}}joinReviews(){if(this.socket){this.socket.emit('join_reviews');}}// Event listeners management\non(event,callback){if(this.socket){this.socket.on(event,callback);// Track listeners for cleanup\nif(!this.listeners.has(event)){this.listeners.set(event,[]);}this.listeners.get(event).push(callback);}}off(event,callback){if(this.socket){this.socket.off(event,callback);}}// Specific event listeners\nonAnnouncementCreated(callback){this.on('announcement_created',callback);}onAnnouncementUpdated(callback){this.on('announcement_updated',callback);}onAnnouncementDeleted(callback){this.on('announcement_deleted',callback);}onSchoolCreated(callback){this.on('school_created',callback);}onSchoolUpdated(callback){this.on('school_updated',callback);}onSchoolDeleted(callback){this.on('school_deleted',callback);}onReviewCreated(callback){this.on('review_created',callback);}onReviewUpdated(callback){this.on('review_updated',callback);}onReviewDeleted(callback){this.on('review_deleted',callback);}onInquiryCreated(callback){this.on('inquiry_created',callback);}// Remove all listeners\nremoveAllListeners(){if(this.socket){this.socket.removeAllListeners();}this.listeners.clear();}disconnect(){if(this.socket){console.log('ðŸ”Œ Disconnecting WebSocket...');this.removeAllListeners();this.socket.disconnect();this.socket=null;this.isConnected=false;}}getConnectionStatus(){return this.isConnected;}}export const socketService=new SocketService();","map":{"version":3,"names":["io","SOCKET_CONFIG","SocketService","constructor","socket","isConnected","listeners","Map","connect","console","log","URL","transports","timeout","on","reason","error","data","message","joinAnnouncements","emit","joinSchools","joinReviews","event","callback","has","set","get","push","off","onAnnouncementCreated","onAnnouncementUpdated","onAnnouncementDeleted","onSchoolCreated","onSchoolUpdated","onSchoolDeleted","onReviewCreated","onReviewUpdated","onReviewDeleted","onInquiryCreated","removeAllListeners","clear","disconnect","getConnectionStatus","socketService"],"sources":["C:/jbmmsi/client/src/services/socketService.js"],"sourcesContent":["import { io } from 'socket.io-client';\r\nimport { SOCKET_CONFIG } from '../config';\r\n\r\nclass SocketService {\r\n  constructor() {\r\n    this.socket = null;\r\n    this.isConnected = false;\r\n    this.listeners = new Map();\r\n  }\r\n\r\n  connect() {\r\n    if (this.socket && this.isConnected) {\r\n      return this.socket;\r\n    }\r\n\r\n    console.log('ðŸ”Œ Connecting to WebSocket...');\r\n    this.socket = io(SOCKET_CONFIG.URL, {\r\n      transports: ['websocket', 'polling'],\r\n      timeout: 10000\r\n    });\r\n\r\n    this.socket.on('connect', () => {\r\n      console.log('âœ… Connected to server via WebSocket');\r\n      this.isConnected = true;\r\n    });\r\n\r\n    this.socket.on('disconnect', (reason) => {\r\n      console.log('âŒ Disconnected from server:', reason);\r\n      this.isConnected = false;\r\n    });\r\n\r\n    this.socket.on('connect_error', (error) => {\r\n      console.error('âŒ WebSocket connection error:', error);\r\n      this.isConnected = false;\r\n    });\r\n\r\n    this.socket.on('connected', (data) => {\r\n      console.log('Server connection confirmed:', data.message);\r\n    });\r\n\r\n    return this.socket;\r\n  }\r\n\r\n  // Join specific rooms\r\n  joinAnnouncements() {\r\n    if (this.socket) {\r\n      this.socket.emit('join_announcements');\r\n    }\r\n  }\r\n\r\n  joinSchools() {\r\n    if (this.socket) {\r\n      this.socket.emit('join_schools');\r\n    }\r\n  }\r\n\r\n  joinReviews() {\r\n    if (this.socket) {\r\n      this.socket.emit('join_reviews');\r\n    }\r\n  }\r\n\r\n  // Event listeners management\r\n  on(event, callback) {\r\n    if (this.socket) {\r\n      this.socket.on(event, callback);\r\n      \r\n      // Track listeners for cleanup\r\n      if (!this.listeners.has(event)) {\r\n        this.listeners.set(event, []);\r\n      }\r\n      this.listeners.get(event).push(callback);\r\n    }\r\n  }\r\n\r\n  off(event, callback) {\r\n    if (this.socket) {\r\n      this.socket.off(event, callback);\r\n    }\r\n  }\r\n\r\n  // Specific event listeners\r\n  onAnnouncementCreated(callback) {\r\n    this.on('announcement_created', callback);\r\n  }\r\n\r\n  onAnnouncementUpdated(callback) {\r\n    this.on('announcement_updated', callback);\r\n  }\r\n\r\n  onAnnouncementDeleted(callback) {\r\n    this.on('announcement_deleted', callback);\r\n  }\r\n\r\n  onSchoolCreated(callback) {\r\n    this.on('school_created', callback);\r\n  }\r\n\r\n  onSchoolUpdated(callback) {\r\n    this.on('school_updated', callback);\r\n  }\r\n\r\n  onSchoolDeleted(callback) {\r\n    this.on('school_deleted', callback);\r\n  }\r\n\r\n  onReviewCreated(callback) {\r\n    this.on('review_created', callback);\r\n  }\r\n\r\n  onReviewUpdated(callback) {\r\n    this.on('review_updated', callback);\r\n  }\r\n\r\n  onReviewDeleted(callback) {\r\n    this.on('review_deleted', callback);\r\n  }\r\n\r\n  onInquiryCreated(callback) {\r\n    this.on('inquiry_created', callback);\r\n  }\r\n\r\n  // Remove all listeners\r\n  removeAllListeners() {\r\n    if (this.socket) {\r\n      this.socket.removeAllListeners();\r\n    }\r\n    this.listeners.clear();\r\n  }\r\n\r\n  disconnect() {\r\n    if (this.socket) {\r\n      console.log('ðŸ”Œ Disconnecting WebSocket...');\r\n      this.removeAllListeners();\r\n      this.socket.disconnect();\r\n      this.socket = null;\r\n      this.isConnected = false;\r\n    }\r\n  }\r\n\r\n  getConnectionStatus() {\r\n    return this.isConnected;\r\n  }\r\n}\r\n\r\nexport const socketService = new SocketService();"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}